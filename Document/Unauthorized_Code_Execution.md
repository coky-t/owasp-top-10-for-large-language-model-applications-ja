### LLM04:2023 - 認可されていないコード実行 (Unauthorized Code Execution)

**説明:**
認可されていないコード実行は攻撃者が LLM を悪用して、自然言語プロンプトを通じて基盤となるシステム上で悪意のあるコード、コマンド、アクションを実行する際に発生します。

**一般的な認可されていないコード実行の脆弱性:**
- ユーザー入力のサニタイズや制限に失敗し、攻撃者が認可されていないコードの実行をトリガーするプロンプトを作成できます。
- LLM の機能に対する不十分なサンドボックス化や不十分な制限のため、意図しない方法で基盤とするシステムとやり取りできます。
- LLM へのシステムレベルの機能やインタフェースを意図せず公開します。

**防止方法:**
- 厳密な入力バリデーションおよびサニタイズプロセスを実装して、悪意のあるプロンプトや予期しないプロンプトが LLM によって処理されることを防止します。
- 適切なサンドボックス化を確保し、LLM の機能を制限して、基盤となるシステムとやり取りする機能を制限します。
- 定期的に LLM の環境とアクセス制御を監査およびレビューし、認可されていないアクションができないようにします。
- LLM インタラクションを監視しログ記録して、潜在的な認可されていないコード実行の問題を検出し分析します。

**攻撃シナリオの例:**
_シナリオ #1:_ 攻撃者は基盤となるシステム上でリバースシェルを起動するコメントを実行するよう LLM に指示するプロンプトを作成し、攻撃者に認可されていないアクセスを付与します。

_シナリオ #2:_ LLM は意図せずにシステムレベル API とのやり取りを許可され、攻撃者は LLM を操作してシステム上で認可されていないアクションを実行します。

認可されていないコード実行に関連するリスクを理解して対処することで、開発者は LLM 実装をより適切に保護し、システムの安全性とセキュリティを確保できます。
